<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
  .axis path {
    fill: none;
    stroke: grey;
    shape-rendering: crispEdges;
  }
  .axis text {
  }
  .tick line {
    stroke: grey;
    shape-rendering: crispEdges;
  }
  .axis .grid {
    stroke: grey;
    shape-rendering: crispEdges;
  }
  </style>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>
<body>
  <script>
    var RANDOM_MIN = 0, RANDOM_MAX = 100;
    // Функция генерации случайного целого числа в диапазоне [lo..up]
    function irand(lo, up) { return Math.floor(Math.random()*(up-lo+1)+lo); }
    // Массив случайных чисел
    var data = []; for (var i=0; i<10; i++) { data.push(irand(RANDOM_MIN, RANDOM_MAX)); }
    // Внешние размеры области диаграммы
    var CHART_WIDTH = 500,
        CHART_HEIGHT = 300;

    var
      AXIS_SIZE = 30, // Отступ для оси
      PADDING = 5;    // Дополнительный зазор между

    // Размер непосредственно графика = общий размер минус сумма отступов по сторонам
    var
      PLOT_AREA_WIDTH = CHART_WIDTH - 2*(AXIS_SIZE + PADDING),
      PLOT_AREA_HEIGHT = CHART_HEIGHT - 2*(AXIS_SIZE + PADDING);

    var
      // Общая высота для каждого прямоугольника =
      // = доступная высота, деленная на число элементов данных
      BAR_AVAIL_HEIGHT = PLOT_AREA_HEIGHT / data.length,
      // Зазоры сверху и снизу прямоугольника
      BAR_SPACING_TOP = 1, BAR_SPACING_BOTTOM = BAR_SPACING_TOP,
      // Собственно высота прямоугольника
      BAR_HEIGHT = BAR_AVAIL_HEIGHT - BAR_SPACING_TOP - BAR_SPACING_BOTTOM;

    var chart_area = d3
          .select('body')
          .append('svg') // Добавляем элемент svg
          .attr('class', 'chart_area') // Задаем класс
          // При задании размеров и координат единицы измерения не указываются
          .attr('width', CHART_WIDTH)    // ширина
          .attr('height', CHART_HEIGHT)  // и высота
    ;

    var widthScale = d3.scale.linear()
        .domain([
          d3.min(data, function(d,i) { return d; }), 
          d3.max(data, function(d,i) { return d; })  
        ])
        .range([0,  PLOT_AREA_WIDTH])
        .nice()
    ;

    var bars = chart_area
          .selectAll('rect')
          .data(data)
          .enter()
          .append('rect')
    ;

    bars
          .attr('x', AXIS_SIZE+PADDING)
          .attr('y', function(d,i) { return AXIS_SIZE+ PADDING + i*BAR_AVAIL_HEIGHT + BAR_SPACING_TOP; })
          .attr('width', function(d, i){ return widthScale(d);})
          .attr('height', BAR_HEIGHT)
          .attr('fill', function(d, i) { return 'hsl(240,50%,'+(75-d/4)+'%)'; })
    ;

    var htAxis = d3.svg.axis()
        .scale(widthScale)
        .orient('top')
    ;

    var hbAxis = d3.svg.axis()
        .scale(widthScale)
        .orient('bottom')
    ;

    chart_area
      .append('g')
      .attr('transform', 'translate('+(AXIS_SIZE+PADDING)+','+(AXIS_SIZE)+')')
      .classed('axis', true)
      .call(htAxis)
    ;


    var hbaxis_area = chart_area
      .append('g')
      .attr('transform', 'translate('+(AXIS_SIZE+PADDING)+','+(CHART_HEIGHT-AXIS_SIZE)+')')
      .classed('axis', true)
      .call(hbAxis)
    ;

    hbaxis_area
      .selectAll('line.minor')
      .data(widthScale.ticks(20))
      .enter()
      .append('line')
      .attr('class', 'grid')
      .attr('y1', 0)
      .attr('y2', -PLOT_AREA_HEIGHT - 2*PADDING)
      .attr('x1', widthScale)
      .attr('x2', widthScale)
      .attr('stroke-dasharray', '5,5')
    ;


  </script>
</body>
</html>
